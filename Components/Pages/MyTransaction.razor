@* @page "/mytransaction" *@
@* @using MauiApp1.Models *@
@* @inject UserService UserService *@

@* <h1 class="text-3xl font-bold mb-6">User Transactions</h1> *@

@* <div class="overflow-x-auto shadow-md rounded-lg"> *@
@*     <table class="min-w-full bg-white border border-gray-200"> *@
@*         <thead class="bg-gray-50 border-b-2 border-gray-200"> *@
@*             <tr> *@
@*                 <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Transaction ID</th> *@
@*                 <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Main Balance</th> *@
@*                 <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Debit</th> *@
@*                 <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Credit</th> *@
@*                 <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Date</th> *@
@*                 <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Description</th> *@
@*             </tr> *@
@*         </thead> *@
@*         <tbody class="divide-y divide-gray-100"> *@
@*             @foreach (var transaction in Data.Transactions) *@
@*             { *@
@*                     <tr class="hover:bg-gray-50"> *@
@*                         <td class="px-4 py-2 text-sm text-gray-700">@transaction.Id</td> *@
@*                         <td class="px-4 py-2 text-sm text-gray-700">@((Data.Transactions.Sum(t => t.Credit) - Data.Transactions.Sum(t => t.Debit)).ToString("C"))</td> *@
@*                         <td class="px-4 py-2 text-sm text-red-500">@transaction.Debit.ToString("C")</td> *@
@*                         <td class="px-4 py-2 text-sm text-green-500">@transaction.Credit.ToString("C")</td> *@
@*                         <td class="px-4 py-2 text-sm text-gray-700">@transaction.Date.ToString("MM/dd/yyyy")</td> *@
@*                         <td class="px-4 py-2 text-sm text-gray-700">@transaction.Description</td> *@
@*                     </tr> *@
@*             } *@
@*         </tbody> *@
@*     </table> *@
@* </div> *@

@* <h2 class="text-2xl font-semibold mt-8 mb-4">Add New Transaction</h2> *@
@* <EditForm Model="newTransaction" OnValidSubmit="HandleTransactionSubmit"> *@
@*     <DataAnnotationsValidator /> *@
@*     <ValidationSummary class="mb-4 text-red-500" /> *@

@*     <div class="grid grid-cols-1 gap-4 md:grid-cols-2"> *@
@*         <div> *@
@*             <label for="debit" class="block text-sm font-medium text-gray-700">Debit</label> *@
@*             <InputNumber id="debit" @bind-Value="newTransaction.Debit" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500" /> *@
@*         </div> *@

@*         <div> *@
@*             <label for="credit" class="block text-sm font-medium text-gray-700">Credit</label> *@
@*             <InputNumber id="credit" @bind-Value="newTransaction.Credit" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500" /> *@
@*         </div> *@

@*         <div class="md:col-span-2"> *@
@*             <label for="description" class="block text-sm font-medium text-gray-700">Description</label> *@
@*             <InputText id="description" @bind-Value="newTransaction.Description" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500" /> *@
@*         </div> *@

@*         <div class="md:col-span-2"> *@
@*             <button type="submit" class="mt-4 px-6 py-2 bg-blue-600 text-white font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"> *@
@*                 Add Transaction *@
@*             </button> *@
@*         </div> *@
@*     </div> *@
@* </EditForm> *@

@* @code { *@
@*     private AppData Data; *@
@*     private Transaction newTransaction = new Transaction(); *@

@*     protected override void OnInitialized() *@
@*     { *@
@*         Data = UserService.LoadData(); *@
@*     } *@

@*     private void HandleTransactionSubmit() *@
@*     { *@
@*         newTransaction.Id = Data.Transactions.Count + 1; *@
@*         newTransaction.Date = DateTime.Now; *@
@*         Data.Transactions.Add(newTransaction); *@
@*         UserService.SaveData(Data); *@

@*         // Reset form *@
@*         newTransaction = new Transaction(); *@
@*     } *@
@* } *@


@page "/mytransaction"
@using MauiApp1.Models
@inject UserService UserService

<h1 class="text-3xl font-bold mb-6">User Transactions</h1>

<div class="overflow-x-auto shadow-md rounded-lg">
    <table class="min-w-full bg-white border border-gray-200">
        <thead class="bg-gray-50 border-b-2 border-gray-200">
            <tr>
                <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Transaction ID</th>
                <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Main Balance</th>
                <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Debit</th>
                <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Credit</th>
                <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Date</th>
                <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Description</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-100">
            @foreach (var transaction in Data.Transactions)
            {
                    <tr class="hover:bg-gray-50">
                        <td class="px-4 py-2 text-sm text-gray-700">@transaction.Id</td>
                        <td class="px-4 py-2 text-sm text-gray-700">@((Data.Transactions.Sum(t => t.Credit) - Data.Transactions.Sum(t => t.Debit)).ToString("C"))</td>
                        <td class="px-4 py-2 text-sm text-red-500">@transaction.Debit.ToString("C")</td>
                        <td class="px-4 py-2 text-sm text-green-500">@transaction.Credit.ToString("C")</td>
                        <td class="px-4 py-2 text-sm text-gray-700">@transaction.Date.ToString("MM/dd/yyyy")</td>
                        <td class="px-4 py-2 text-sm text-gray-700">@transaction.Description</td>
                    </tr>
            }
        </tbody>
    </table>
</div>

<h2 class="text-2xl font-semibold mt-8 mb-4">Add New Transaction</h2>
<EditForm Model="newTransaction" OnValidSubmit="HandleTransactionSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary class="mb-4 text-red-500" />

    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <div>
            <label for="debit" class="block text-sm font-medium text-gray-700">Debit</label>
            <InputNumber id="debit" @bind-Value="newTransaction.Debit" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500" />
        </div>

        <div>
            <label for="credit" class="block text-sm font-medium text-gray-700">Credit</label>
            <InputNumber id="credit" @bind-Value="newTransaction.Credit" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500" />
        </div>

        <div class="md:col-span-2">
            <label for="description" class="block text-sm font-medium text-gray-700">Description</label>
            <InputText id="description" @bind-Value="newTransaction.Description" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500" />
        </div>

        <div class="md:col-span-2">
            <button type="submit" class="mt-4 px-6 py-2 bg-blue-600 text-white font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                Add Transaction
            </button>
        </div>
    </div>
</EditForm>

@code {
    private AppData Data;
    private Transaction newTransaction = new Transaction();

    protected override void OnInitialized()
    {
        Data = UserService.LoadData();
    }

    private void HandleTransactionSubmit()
    {
        newTransaction.Id = Data.Transactions.Count + 1;
        newTransaction.Date = DateTime.Now;
        Data.Transactions.Add(newTransaction);
        UserService.SaveData(Data);

        // Reset form
        newTransaction = new Transaction();
    }
}
